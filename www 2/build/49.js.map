{"version":3,"sources":["../../src/pages/buygiftcards/buygiftcards.module.ts","../../src/pages/buygiftcards/buygiftcards.ts"],"names":[],"mappings":"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","file":"49.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { BuygiftcardsPage } from './buygiftcards';\n\n@NgModule({\n  declarations: [\n    BuygiftcardsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(BuygiftcardsPage),\n  ],\n})\nexport class BuygiftcardsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/buygiftcards/buygiftcards.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, App, ViewController, LoadingController, AlertController } from 'ionic-angular';\nimport { Stripe } from '@ionic-native/stripe';\nimport { Http } from '@angular/http';\nimport { HomePage } from \"../home/home\";\nimport { ModalController } from 'ionic-angular';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { GlobalVariable } from '../../app/global';\nimport { NativeStorage } from \"@ionic-native/native-storage\";\nimport { ServerProvider } from \"../../providers/server/server\";\n\n@IonicPage()\n@Component({\n  selector: 'page-buygiftcards',\n  templateUrl: 'buygiftcards.html',\n})\nexport class BuygiftcardsPage {\n  cardinfo: any = {\n    number: '',\n    expMonth: '',\n    expYear: '',\n    cvc: ''\n}\nsubmitAttempt: boolean = false;\nPaymentForm: FormGroup;\ngift_id:any;\nudid_r:any;\ndesign_card:any;\nmessage:any;\namount:any;\naction:any='';\ncash_discount = 0;\n\n  constructor(public server: ServerProvider, private nativeStorage: NativeStorage, public alertCtrl: AlertController, public loadingCtrl: LoadingController, public globals: GlobalVariable,public viewCtrl: ViewController, public formBuilder: FormBuilder, public stripe: Stripe, public http: Http, public navCtrl: NavController, public navParams: NavParams) {\n    this.PaymentForm = formBuilder.group({\n      creditcardno: ['', Validators.compose([Validators.minLength(10), Validators.maxLength(16), Validators.pattern('[0-9]*'), Validators.required])],\n      expiryMonth: ['', Validators.compose([Validators.required])],\n      expiryYear: ['', Validators.compose([Validators.required])],\n      CVC: ['', Validators.compose([Validators.required])],\n      cardinfo: [false]\n  })\n  this.gift_id = this.navParams.get('gift_id');\n  this.udid_r = this.navParams.get('udid_r');\n  this.design_card = this.navParams.get('design_id');\n  this.message = this.navParams.get('message');\n  this.amount = this.navParams.get('amount');\n  this.action = this.navParams.get('action');\n\n\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad BuygiftcardsPage');\n  }\n  pay(PaymentData: any) {\n\n    var a = btoa(PaymentData.creditcardno)\n    console.log(\"encode\", a);\n    console.log(\"decode\", atob(a));\n    console.log(PaymentData.creditcardno);\n    console.log(this.udid_r)\n    if (!this.PaymentForm.valid) {\n        this.submitAttempt = true;\n        console.log(' Some values were not given or were incorrect, please fill them');\n    } else {\n\n        console.log(\"paymentcard\", PaymentData.cardinfo);\n        if (PaymentData.cardinfo == true) {\n            this.nativeStorage.setItem('card',\n                {\n                    cardno: btoa(PaymentData.creditcardno),\n                    exmonth: btoa(PaymentData.expiryMonth),\n                    exyear: btoa(PaymentData.expiryYear),\n                    cvc: btoa(PaymentData.CVC),\n                    check: btoa(PaymentData.cardinfo)\n                }).then(() => console.log('Stored item!'),\n                    error => console.error('Error storing item', error)\n                );\n        }\n\n\n        this.cardinfo = {\n            number: PaymentData.creditcardno,\n            expMonth: PaymentData.expiryMonth,\n            expYear: PaymentData.expiryYear,\n            cvc: PaymentData.CVC\n        }\n\n        console.log(this.cardinfo);\n        let loading = this.loadingCtrl.create({\n            content: \"Loading...\",\n\n        });\n        loading.present();\n        if(this.globals.authorize_enabled){\n            let response = this.server.buy_gift_cards('', this.gift_id,this.udid_r,this.design_card,this.amount,this.message,this.action,this.cardinfo)\n         \n           console.log(\"response without json\", response);\n            response.subscribe(data => {\n                this.globals.presentToast(data.message)\n                this.navCtrl.pop().then(() => this.navCtrl.pop());\n                loading.dismiss();\n            }\n                , error => {\n                loading.dismiss();\n                    this.globals.presentToast(\"Payment Failed\")\n                });\n        }\n        else{\n            if (this.globals.StripId == '') {\n                loading.dismiss();\n    \n                let alert = this.alertCtrl.create({\n                    title: 'Oops',\n                    subTitle: 'Payments not available,please try again',\n                    buttons: ['OK']\n                });\n    \n                alert.present();\n            }\n            else {\n                \n    \n                this.stripe.setPublishableKey(this.globals.StripId);\n                this.stripe.createCardToken(this.cardinfo).then((Token) => {\n                   \n                    let response = this.server.buy_gift_cards( Token.id, this.gift_id,this.udid_r,this.design_card,this.amount,this.message,this.action)\n                    console.log(\"response without json\", response);\n                    response.subscribe(data => {\n                        this.globals.presentToast(data.message)\n                        this.navCtrl.pop().then(() => this.navCtrl.pop());\n\n                        loading.dismiss();\n                      \n    \n                    }\n                        , error => {\n                        loading.dismiss();\n                        this.globals.presentToast(\"Payment Failed\")\n\n                            console.log(\"Error!\");\n                            console.log(\"this is our error\", error);\n    \n                        });\n    \n                }).catch((data) => {\n                    loading.dismiss();\n                    this.globals.presentToast(\"Invalid Credentials,please try again\")\n    \n                });\n            }\n        }\n        \n    }\n}\n\ncancel(){\n    this.navCtrl.pop();\n}\n\ncash_discount_confirmation(payment_data) {\n    if (this.globals.cash_discount_enabled  && !this.cash_discount) {\n        var discount_: any = ((Number(this.globals.cash_discount_percentage) / 100) * Number(this.amount)).toFixed(2);\n\n        discount_ = (Number(discount_) + Number(this.globals.cash_discount_value));\n\n        let alert = this.alertCtrl.create({\n            title: 'Please Note',\n            message: ' Your total amount will be $' + (Number(this.amount) + Number(discount_)).toFixed(2) + ' as of convenience charge.',\n            buttons: [\n                {\n                    text: 'Cancel',\n                    role: 'cancel',\n                    handler: () => {\n                        console.log('Cancel clicked');\n\n                    }\n                },\n                {\n                    text: 'OK',\n                    handler: () => {\n                        this.cash_discount = discount_;\n                        this.amount = (Number(this.amount) + Number(discount_)).toFixed(2);\n\n                        this.pay(payment_data)\n                    }\n                }\n            ]\n        });\n        alert.present();\n    }\n    else {\n        this.pay(payment_data)\n    }\n\n}\n\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/buygiftcards/buygiftcards.ts"],"sourceRoot":""}