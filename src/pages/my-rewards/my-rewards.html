<!--
  Generated template for the MyRewardsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <ion-title>My Rewards</ion-title>
  </ion-navbar>

</ion-header>


<ion-content>

  <ion-segment  color="primary" [(ngModel)]="option" (ionChange)="SegmentChange()">
    <!-- <ion-segment-button style="font-size:1.1rem" value="gain">
      <ion-badge color="danger" item-left *ngIf="globals.RewardCount > 0">{{globals.RewardCount}}</ion-badge>
      GAIN
    </ion-segment-button> -->
   
    <ion-segment-button style="font-size:1.1rem" value="points">
      <ion-badge color="danger" item-left *ngIf="globals.PointCount > 0">{{globals.PointCount}}</ion-badge>
      POINTS
    </ion-segment-button>
    <ion-segment-button style="font-size:1.1rem" value="punch_cards" (click)="getPunchReward()">
        <ion-badge color="danger" item-left *ngIf="globals.punchCount > 0">{{globals.punchCount}}</ion-badge>
        PUNCH CARDS
      </ion-segment-button>
    <ion-segment-button style="font-size:1.1rem" value="gifts">
      <ion-badge color="danger" item-left *ngIf="globals.BirthCount > 0">{{globals.BirthCount}}</ion-badge>
      GIFTS
    </ion-segment-button>
  </ion-segment>


  <div [ngSwitch]="option" style="height: 100%;">
    <!-- <div *ngSwitchCase="'gain'">
      <ion-searchbar *ngIf="!flag" [(ngModel)]="searchTerm" (input)="setFilteredItems()" [formControl]="searchControl"></ion-searchbar>

      <p style="text-align: center; margin-top: 60%;" *ngIf="gain_flag">Currently you do not have any rewards... </p>
      <ion-refresher style="top:10% !important;" (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull down to refresh" refreshingSpinner="circles" refreshingText="Refreshing...">
        </ion-refresher-content>
      </ion-refresher>
      <div *ngIf="!gain_flag">
        <div *ngFor="let rewards of lotery">
          <ion-card *ngIf="rewards.is_birthday == 'false'" style="    margin-right: 4px !important;
              margin-left: 4px !important; width: calc(100% - 8px)!important;">
            <ion-grid>
              <ion-row>
                <ion-col col-3>
                  <img style="border-radius: 4px; height:70px;" src="{{rewards?.image}}">
                </ion-col>

                <ion-col col-6>
                  <h3 color="primary" style=" font-size: 1.4rem;color:#666;font-weight:bold">{{rewards?.businessname}} </h3>
                  <ion-label style="color:black" *ngIf="rewards.isnumber == true ">Store Credit:
                    <p style="color:red; font-size: 3rem;"> ${{rewards?.reward}} </p>
                  </ion-label>
                  <p style="color:red; font-size: 2.0rem;" *ngIf="rewards.isnumber == false"> {{rewards?.reward_string}} </p>
                    <p > Date:   {{rewards?.date}} </p>
                </ion-col>

                <ion-col style="padding: 0px !important;" col-3>
                  <img src="{{rewards?.redeem_qr}}">
                  <p style="text-align:center;"> {{rewards?.qr_text}}</p>
                </ion-col>
              </ion-row>

            </ion-grid>

          </ion-card>

        </div>
      </div>

    </div> -->
    <div *ngSwitchCase="'punch_cards'" class="back">
      <!-- <ion-searchbar *ngIf="!flag" [(ngModel)]="searchTerm" (input)="setFilteredItems()" [formControl]="searchControl"></ion-searchbar> -->

      <p style="text-align: center; margin-top: 60%;" *ngIf="punchflag">Currently you do not have any punch cards... </p>
      <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull down to refresh" refreshingSpinner="circles" refreshingText="Refreshing...">
        </ion-refresher-content>
      </ion-refresher>
      <div class="circle" id="circles2"></div>

      <div *ngIf="!punchflag">

        <!-- <ion-card *ngFor="let rewards of punchdata" style="margin-right: 4px !important;
    margin-left: 4px !important; width: calc(100% - 8px)!important;" (click)="detailPunch(rewards.punched_icon_image,rewards.business_username,rewards.punch_count,rewards.punch_limit,rewards.punch_qr,udid,rewards.punched_image,rewards.date,rewards.lowestreward)">
          <ion-grid>
            <ion-row>
              <ion-col col-3>
                <img style="border-radius: 4px; height:70px;" src="{{rewards?.business_logo}}">
              </ion-col>

              <ion-col col-6>
                <h6 color="primary" style=" font-size: 1.4rem;color:#666;font-weight:bold">{{rewards?.business_username}} </h6>
                <ion-label style="display:inline-flex;    margin: 5px;
                margin-left: 0;margin-bottom:0;color:#666;font-weight:bold">Count:
                  <p style="color: #333;margin-left:5px;margin-top: 4px;"> {{rewards?.punch_count}}/{{rewards?.punch_limit}} </p>
                </ion-label>
                <ion-label style="margin-top:0;margin-bottom: 2px;color:#666;font-weight:bold;">Reward: {{rewards?.lowestreward}}</ion-label>
                
                 <p > Date:   {{rewards?.date}} </p>
              </ion-col>

              <ion-col style="padding: 0px !important;" col-3>
                <img src="{{rewards?.punch_qr}}">
                <p style="text-align:center;"> {{udid}}</p>
              </ion-col>
            </ion-row>

          </ion-grid>

        </ion-card> -->
        <div *ngFor="let rewards of punchdata">
            <div style="height:90%">

                <!-- <img style="padding: 10px; height:100%" src="{{rewards.punched_image}}"> -->
                <!-- <div class = "punch-logo">    
                   <div style="display:inline-block; padding:5px;" *ngFor="let item of createRange(punch_count)" >
                  <img style="height:50px; width: 50px;" src="{{punched_icon_image}}">    
                 </div>       
                  <div style="display:inline-block; padding:5px;" *ngFor="let item of createRange2(punch_limit,punch_count)" >
                  <img style="height:50px;opacity: 0.5; width: 50px; " src="{{punched_icon_image}}">
                 </div>
                 </div> -->
                <!-- <div style="    position: absolute;  bottom: 12%;  width: 100%; text-align:center;">
                 <img style="    height: 70px; width:70px;  margin-left: 39%;" src="{{punch_qr}}">
                 <ion-label style="margin-top:0;     text-shadow: -1px -1px 0 #f8f8f8, 1px -1px 0 #f8f8f8, -1px 1px 0 #f8f8f8, 1px 1px 0 #f8f8f8;">{{udid}}</ion-label>   
                 </div> -->
                <!--<div style="top: 5%; position: absolute;width: 100%;"><h1 style="text-align:center;color:rgb(140,133,177); ">{{business_username}} </h1> </div>-->
                <div style="    position: absolute;
                  top: 27%;
                  width: 100%;">
                  <ion-label *ngIf="rewards.punch_count.length == 2" class="Open-Sans-bold" style="font-size: 10rem;margin: 10px;position: absolute;   margin-left: 28%;  color:black">{{rewards.punch_count}} </ion-label>
                  <p *ngIf="rewards.punch_count.length == 2" style="    position: absolute;    top: 84px; font-size: 3rem;  left: 57%;  color: black;">
                    /{{rewards.punch_limit}}</p>
            
                  <ion-label *ngIf="rewards.punch_count.length == 3" class="Open-Sans-bold" style="font-size: 10rem;margin: 10px;position: absolute;   margin-left: 15%;color:black">{{rewards.punch_count}} </ion-label>
                  <p *ngIf="rewards.punch_count.length == 3" style="    position: absolute;    top: 84px; font-size: 3rem;  left: 59%;  color: black;">
                    /{{rewards.punch_limit}}</p>
            
                  <ion-label *ngIf="rewards.punch_count.length == 1" class="Open-Sans-bold" style="font-size: 10rem;margin: 10px;position: absolute;      margin-left: 37%;    color:black">{{rewards.punch_count}} </ion-label>
                  <p *ngIf="rewards.punch_count.length == 1 " style="    position: absolute;    top: 84px; font-size: 3rem;      left: 51%;  color:black">
                    /{{rewards.punch_limit}} </p>
            
                </div>
               
                </div>
        </div>

      </div>
    </div>
    <div *ngSwitchCase="'points'">
      <ion-searchbar *ngIf="!flag" [(ngModel)]="searchTerm" (input)="setFilteredItems()" [formControl]="searchControl"></ion-searchbar>
      <div col-6 class="point_s">
          <div class="youhave">You Have</div>
           <div class="points_design" *ngIf="globals.points_">{{globals.points_}} <ion-icon class="point-star" name="star"></ion-icon></div>
           <div class="points_design" *ngIf="!globals.points_">0 <ion-icon class="point-star" name="star"></ion-icon></div>

           <div class="pts">Points</div> 
      </div>
      <p style="text-align: center; margin-top: 27%;" *ngIf="pointflag">Currently you do not have any points... </p>
      <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull down to refresh" refreshingSpinner="circles" refreshingText="Refreshing...">
        </ion-refresher-content>
      </ion-refresher>
      <div *ngIf="!pointflag">
        <div *ngFor="let rewards of points_lotery">
          <ion-card *ngFor="let reward of rewards.available_rewards" >
            <ion-grid>
              <ion-row>
                <ion-col col-3>
                  <img style="border-radius: 4px; height:70px;    height: 70px;
                  width: 70px;
                  object-fit: cover;
                  border-radius: 50%;" src="{{rewards?.image}}">
                </ion-col>

                <ion-col col-6 style="font-size: 19px;
                margin-top: 12px;">
                <h4>Rewards</h4>
                  {{reward.description}}
                  
                </ion-col>

                <ion-col style="font-size: 22px;
                margin-top: 12px;"  text-center col-3>
                <h4>Points</h4>
                  {{reward.points}}
                </ion-col>
              </ion-row>

            </ion-grid>

          </ion-card>

        </div>
      </div>

    </div>
    <div *ngSwitchCase="'gifts'">
      <ion-searchbar *ngIf="!flag" [(ngModel)]="searchTerm" (input)="setFilteredItems()" [formControl]="searchControl"></ion-searchbar>
      <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull down to refresh" refreshingSpinner="circles" refreshingText="Refreshing...">
        </ion-refresher-content>
      </ion-refresher>
      <p style="text-align: center; margin-top: 60%;" *ngIf="gain_flag">Currently you do not have any rewards... </p>


      <div *ngIf="!gain_flag">
        <div *ngFor="let rewards of lotery">
          <ion-card *ngIf="rewards.is_birthday == 'true'" style="    margin-right: 4px !important;
                  margin-left: 4px !important; width: calc(100% - 8px)!important;">
            <ion-grid>
              <ion-row>
                <ion-col col-3>
                  <img style="border-radius: 4px; height:70px;" src="{{rewards?.image}}">
                </ion-col>

                <ion-col col-6>
                  <h3 color="primary" style=" font-size: 1.4rem;color:#666;font-weight:bold">{{rewards?.businessname}} </h3>
                  <ion-label style="color:black" *ngIf="rewards.isnumber == true ">Store Credit:
                    <p style="color:red; font-size: 3rem;"> ${{rewards?.reward}} </p>
                  </ion-label>
                  <p style="color:red; font-size: 2.0rem;" *ngIf="rewards.isnumber == false"> {{rewards?.reward_string}} </p>
                    <p > Date:   {{rewards?.date}} </p>
                </ion-col>

                <ion-col style="padding: 0px !important;" col-3>
                  <img src="{{rewards?.redeem_qr}}">
                  <p style="text-align:center;"> {{rewards?.qr_text}}</p>
                </ion-col>
              </ion-row>

            </ion-grid>

          </ion-card>
        </div>

      </div>
    </div>
  </div>

</ion-content>